library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.5, size = 1.5,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
print(plot_RBP[[x]])
}
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.5, size = 1.5,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
}
print(plot_RBP[[1]] + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
print(plot.parameters.detail[[1]] + labs(subtitle =
paste("Figure 6: The number of Proteins for each Parameter depending on the occuring
Parameter amount is depicted.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
n <- 9 # Number of protein you want to see
x <- c(1:25)
a1 <- parameter_gaussian_ctrl.zt_table[n, 1]
mu1 <- parameter_gaussian_ctrl.zt_table[n, 2]
sigma1 <- parameter_gaussian_ctrl.zt_table[n, 3]
a2 <- parameter_gaussian_rnase.zt_table[n, 1]
mu2 <- parameter_gaussian_rnase.zt_table[n, 2]
sigma2 <- parameter_gaussian_rnase.zt_table[n, 3]
plot(x, type = "n", ylim = c(0, 20), xlab = "Fractions", ylab = "Protein amount", col = "darkgrey")
title(main = "Gaussian fit MYOME_HUMAN")
curve(gauss(x, a = as.numeric(a1), mu = as.numeric(mu1), sigma = as.numeric(sigma1)), add = TRUE, col = "palegreen2", lwd = 2)
curve(gauss(x, a = as.numeric(a2), mu = as.numeric(mu2), sigma = as.numeric(sigma2)), add = TRUE, col = "violet", lwd = 2)
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.5, size = 1.5,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
}
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("lightsteelblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.7, size = 2,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
}
print(plot_RBP[[1]] + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
print(plot.parameters.detail[[1]] + labs(subtitle =
paste("Figure 6: The number of Proteins for each Parameter depending on the occuring
Parameter amount is depicted.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
knitr::opts_chunk$set(echo = FALSE, results='hide')
load("Environment.RData")
save.image("C:/Users/tinel/OneDrive/Dokumente/RUPRECHT-KARLS-UNIVERSITÃ„T HEIDELBERG/MOBI/HOCHSCHULSEMESTER4/DATAANALYSIS/topic03_team04/Environment.RData")
knitr::opts_chunk$set(echo = FALSE, results='hide')
load("Environment.RData")
print(plot_RBP[[1]] + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.5, size = 1.5,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
}
print(plot_RBP[[1]] + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
print(plot.parameters.detail[[1]] + labs(subtitle =
paste("Figure 6: The number of Proteins for each Parameter depending on the occuring
Parameter amount is depicted.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
print(plot_RBP[[1]] + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
print(plot.parameters.detail[[1]] + labs(subtitle =
paste("Figure 6: The number of Proteins for each Parameter depending on the occuring
Parameter amount is depicted.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.5, size = 1.5,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
print(plot_RBP[[x]])
}
print(plot_RBP[[1]]) + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98"))
print(plot_RBP[[1]] + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
print(plot.parameters.detail[[1]] + labs(subtitle =
paste("Figure 6: The number of Proteins for each Parameter depending on the occuring
Parameter amount is depicted.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98")))
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("lightsteelblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.7, size = 2,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
print(plot_RBP[[x]])+ labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98"))
}
print(plot_RBP[[1]])
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.7, size = 2,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
print(plot_RBP[[x]])+ labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98"))
}
shift_named
shift_named <- cbind(shift_mvm_named, shift_zt_named, shift_mms_named)
plots_RBP <- list()
library("ggplot2")
for (x in 1:3){
col <- c("skyblue2", "darkseagreen3","tomato1", "lightsteelblue4" )
vjust <- c(-0.5, 1, -0.5, -0.5)
labels <- c("left shift", "no shift", "precipitated", "right shift")
title <- c("Shifttypes", "Shifttypes z-Transformation", "Shifttypes Min-Max-Scaling")
peaks <- data.frame(peak.ctrl, peak.rnase, shift_named[,x])
number.of.clusters <- data.frame(value = shift_named[,x])
peaks$cluster <- factor(shift_named[,x])
dot.plot <- ggplot(peaks, aes(peak.ctrl,peak.rnase)) +
geom_point(aes(colour = shift_named[,x]),
shape = 19,
alpha = 0.5, size = 1.5,
position = position_jitter(width = 0.2, height = 0.2))+
labs(x = "Fraction of Control Peak",
y = "Fraction of RNase Peak",
title = title[x])+
coord_equal()+
scale_colour_manual(values = col,labels = labels, name = "shifttypes")+
theme_light()
bar.plot <- ggplot(number.of.clusters, aes(factor(value)))+
geom_bar(fill = col, width = 0.7)+
theme_minimal()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "grey", fill = NA),
panel.background = element_rect(fill = "white", colour = NA))+
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = vjust,
size = 2.7)
plot_RBP[[x]] <- dot.plot + annotation_custom(grob = ggplotGrob(bar.plot),
xmin = 15,
xmax = 26.75,
ymin = -1,
ymax = 8)
print(plot_RBP[[x]])+ labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98"))
}
print(plot_RBP[[1]]) + labs(subtitle = paste("Figure 5: Categorization into shifting behaviour based on global shift.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98"))
library(ggplot2)
parameters.all <- list(parameters.mvm, parameters.zt, parameters.mms)
plot.parameters.detail <- list()
for (z in 1:3){
parameters <- parameters.all[[z]]
if(z == 3){
g <- 2
}else{g <- 3}
for (y in 1:dim(parameters)[1]){
if (parameters[y,g] == "no shift"){
parameters[y,g] <- 0
} else{parameters[y,g] <- 1}
}
parameters.m <- as.matrix(parameters)
sum_parameters <- apply(parameters.m, 1, function(x){
sum(as.numeric(x))})
df <- as.data.frame(sum_parameters)
title <- c("Protein spilt by number of Parameters",
"Protein spilt by number of Parameters - zTransformation",
"Protein spilt by number of Parameters - MMS")
if(z == 3){
c <- c(0,1,2,3)
}else{c<- c(0,1,2,3,4)}
if(z == 3){
d <- 0
}
else {d <- 1}
if (z != 3){
df.glob <- as.data.frame(parameters[,d])
df.glob.sum <- as.data.frame(c)
for (x in 0:4){
df.glob.sum[x+1,2] <- sum(df.glob[which(sum_parameters == x),])}}
df.loc <- as.data.frame(parameters[,d+1])
df.loc.sum <- as.data.frame(c)
for (x in 0:(d+3)){
df.loc.sum[x+1,2] <-
sum(as.numeric(df.loc[which(sum_parameters == x),]))}
df.shift <- as.data.frame(parameters[,d+2])
df.shift.sum <- as.data.frame(c)
for (x in 0:(d+3)){
df.shift.sum[x+1,2] <-
sum(as.numeric(df.shift[which(sum_parameters == x),]))}
df.shoulder <- as.data.frame(parameters[,d+3])
df.shoulder.sum <- as.data.frame(c)
for (x in 0:(d+3)){
df.shoulder.sum[x+1,2] <-
sum(df.shoulder[which(sum_parameters == x),])}
df.sum <- as.data.frame(sum_parameters)
df.sum.sum <- as.data.frame(c)
for (x in 0:(d+3)){
df.sum.sum[x+1,2] <- sum(sum_parameters == x)}
if (z != 3){
df2 <- data.frame(category = c(df.glob.sum[,1], df.loc.sum[,1],
df.shift.sum[,1], df.shoulder.sum[,1],
df.sum.sum[,1]),
value = c(df.glob.sum[,2], df.loc.sum[,2],
df.shift.sum[,2], df.shoulder.sum[,2],
df.sum.sum[,2]),
Parameters = c(rep(c("Global", "Local", "Shifts",
"Shoulderregion", "Total"),
each = 5)))
}else{
df2 <- data.frame(category = c(df.loc.sum[,1], df.shift.sum[,1],
df.shoulder.sum[,1],df.sum.sum[,1]),
value = c(df.loc.sum[,2], df.shift.sum[,2],
df.shoulder.sum[,2], df.sum.sum[,2]),
Parameters = c(rep(c("Local", "Shift", "Shoulderregion",
"Total"), each = 4)))
}
if(z == 3){
colour <- c("coral3", "lightsteelblue4","paleturquoise3", "lightsteelblue2" )
}else{colour <- c("coral3", "lightsteelblue4", "darkseagreen3", "paleturquoise3", "lightsteelblue2" )}
plot.parameters.detail[[z]] <-
ggplot(df2, aes(x = category, y = value, fill = Parameters))+
geom_bar(stat = "identity", position = position_dodge(width = 0.9))+
theme_bw()+
geom_text(aes(label = value),
vjust = -0.5,
position = position_dodge(width = 0.9),
size = 2)+
labs(x = "Number of Parameters",
y = "Number of Proteins",
title = title[[z]])+
scale_fill_manual(values = colour)
print(plot.parameters.detail[[z]])
}
print(plot.parameters.detail[[1]]) + labs(subtitle =
paste("Figure 5: The number of Proteins for each Parameter depending on the occuring
Parameter amount is depicted.")) + theme(panel.background = element_rect(fill = "gray98")) + theme(plot.background = element_rect(fill = "gray97")) + theme(legend.background = element_rect(fill = "gray97")) + theme(legend.key = element_rect(fill = "gray98"))
