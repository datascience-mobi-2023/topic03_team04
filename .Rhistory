rnase.rep1.zt.norm.pos <- sweep(rnase.rep1.zt.norm,1,min.rnase.rep1.zt.norm,FUN = '-')
rnase.rep2.zt.norm.pos <- sweep(rnase.rep2.zt.norm,1,min.rnase.rep2.zt.norm,FUN = '-')
rnase.rep3.zt.norm.pos <- sweep(rnase.rep3.zt.norm,1,min.rnase.rep3.zt.norm,FUN = '-')
r1c <- ctrl.rep1.zt.norm
r2c <- ctrl.rep2.zt.norm
r3c <- ctrl.rep3.zt.norm
r1c0 <- ctrl.rep1.zt.norm
r2c0 <- ctrl.rep2.zt.norm
r3c0 <- ctrl.rep3.zt.norm
r1c0[is.na(r1c0)] <- 0
r2c0[is.na(r2c0)] <- 0
r3c0[is.na(r3c0)] <- 0
ctrl.zt.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
View(ctrl.zt.reduced)
dim(ctrl.zt.reduced)
r1c <- ctrl.rep1.zt.norm
r2c <- ctrl.rep2.zt.norm
r3c <- ctrl.rep3.zt.norm
r1c0 <- ctrl.rep1.zt.norm
r2c0 <- ctrl.rep2.zt.norm
r3c0 <- ctrl.rep3.zt.norm
r1c0[is.na(r1c0)] <- 0
r2c0[is.na(r2c0)] <- 0
r3c0[is.na(r3c0)] <- 0
ctrl.zt.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
View(ctrl.zt.reduced)
dim(ctrl.zt.reduced)
r1r <- rnase.rep1.zt.norm
r2r <- rnase.rep2.zt.norm
r3r <- rnase.rep3.zt.norm
r1r0 <- rnase.rep1.zt.norm
r2r0 <- rnase.rep2.zt.norm
r3r0 <- rnase.rep3.zt.norm
r1r0[is.na(r1r0)] <- 0
r2r0[is.na(r2r0)] <- 0
r3r0[is.na(r3r0)] <- 0
rnase.zt.reduced <- (r1r0 + r2r0 + r3r0)/(3 - (sum(as.numeric(is.na(r1r[x,])) + as.numeric(is.na(r2r[x,])) + as.numeric(is.na(r3r[x,]))/25)))
View(rnase.zt.reduced)
dim(rnase.zt.reduced)
ctrl.rep1.zt.scaled =
sweep(ctrl.rep1.zt.norm.pos,1,100/rowSums(ctrl.rep1.zt.norm.pos),'*')
# rowSums(ctrl.rep1.zt.scaled)
ctrl.rep2.zt.scaled =
sweep(ctrl.rep2.zt.norm.pos,1,100/rowSums(ctrl.rep2.zt.norm.pos),'*')
# rowSums(ctrl.rep2.zt.scaled)
ctrl.rep3.zt.scaled =
sweep(ctrl.rep3.zt.norm.pos,1,100/rowSums(ctrl.rep3.zt.norm.pos),'*')
# rowSums(ctrl.rep3.zt.scaled)
ctrl.zt.scaled =
sweep(ctrl.zt.reduced,1,100/rowSums(ctrl.zt.reduced),'*')
rnase.rep1.zt.scaled =
sweep(rnase.rep1.zt.norm.pos,1,100/rowSums(rnase.rep1.zt.norm.pos),'*')
# rowSums(rnase.rep1.zt.scaled)
rnase.rep2.zt.scaled =
sweep(rnase.rep2.zt.norm.pos,1,100/rowSums(rnase.rep2.zt.norm.pos),'*')
# rowSums(rnase.rep2.zt.scaled)
rnase.rep3.zt.scaled =
sweep(rnase.rep3.zt.norm.pos,1,100/rowSums(rnase.rep3.zt.norm.pos),'*')
# rowSums(rnase.rep3.zt.scaled)
rnase.zt.scaled =
sweep(rnase.zt.reduced,1,100/rowSums(rnase.zt.reduced),'*')
# rowSums(rnase.zt.scaled)
ctrl.zt <- ctrl.zt.scaled
rnase.zt <- rnase.zt.scaled
View(ctrl.zt)
Vier(rnase.zt)
ctrl.zt <- ctrl.zt.scaled
rnase.zt <- rnase.zt.scaled
View(ctrl.zt)
View(rnase.zt)
non.reproducible.ctrl <- which(rowSums(ctrl.cor.naremoved<0.9)>2)
#length(non.reproducible.ctrl)
non.reproducible.rnase <- which(rowSums(rnase.cor.naremoved<0.9)>2)
#length(non.reproducible.rnase)
non.reproducible <- unique(c(which(rowSums(ctrl.cor.naremoved<0.9)>2), which(rowSums(rnase.cor.naremoved<0.9)>2)))
#length(non.reproducible)
#View(rnase.cor.naremoved)
#length(non.reproducible)
length(non.reproducible.rnase)
length(non.reproducible.ctrl)
length(non.reproducible)
#View(non.reproducible)
ctrl.rep <- MS.Table.naremoved[-non.reproducible,1:75]
rnase.rep <- MS.Table.naremoved[-non.reproducible,76:150]
ctrl.cor.removed <- ctrl.cor.naremoved [-non.reproducible,]
rnase.cor.removed <- rnase.cor.naremoved [-non.reproducible,]
#View(rnase.rep)
dim(rnase.rep)
dim(ctrl.rep)
View(ctrl.rep)
for (x in 1:dim(ctrl.rep)[1]){
if (ctrl.cor.removed[x, 1] < 0.9) {
if (ctrl.cor.removed[x, 3] < 0.9){
ctrl.rep[x, 1:25] <- NA
}
if (rnase.cor.removed[x, 2] < 0.9){
ctrl.rep[x, 26:50] <- NA
}}
if (rnase.cor.removed[x, 3] < 0.9) {
if (rnase.cor.removed[x, 2] < 0.9){
ctrl.rep[x, 51:75] <- NA
}
}
}
for (x in 1:dim(rnase.rep)[1]){
if (rnase.cor.removed[x, 1] < 0.9) {
if (rnase.cor.removed[x, 3] < 0.9){
rnase.rep[x, 1:25] <- NA
}
if (rnase.cor.removed[x, 2] < 0.9){
rnase.rep[x, 26:50] <- NA
}}
if (rnase.cor.removed[x, 3] < 0.9) {
if (rnase.cor.removed[x, 2] < 0.9){
rnase.rep[x, 51:75] <- NA
}
}
}
#Nr <- c(1:dim(rnase.rep)[1])
#rnase.with.proteinnumbers <- cbind(Nr, rnase.rep[,1:25], Nr, rnase.rep[,26:50], Nr, rnase.rep[,51:75])
#View(rnase.with.proteinnumbers)
#dim(rnase.rep)
#View(rnase.cor.removed)
ctrl.clean <- ctrl.rep
rnase.clean <- rnase.rep
ctrl.rep1 <- ctrl.clean[,1:25]
ctrl.rep2 <- ctrl.clean[,26:50]
ctrl.rep3 <- ctrl.clean[,51:75]
rnase.rep1 <- rnase.clean[,1:25]
rnase.rep2 <- rnase.clean[,26:50]
rnase.rep3 <- rnase.clean[,51:75]
dim(rnase.rep3)
m <- matrix(1:6, nrow = 2)
m
# Subtract the mean of each column from the corresponding elements in the matrix
swept_matrix <- sweep(m, 2, colMeans(m), FUN = "-")
print(swept_matrix)
applied_matrix <- apply(m, 2, function(x) x - mean(x))
print(applied_matrix)
sd.ctrl <- apply(ctrl.rep1, 1, sd)
mean.ctrl.rep1 <- apply(ctrl.rep1, 1, mean)
mean.ctrl.rep2 <- apply(ctrl.rep2, 1, mean)
mean.ctrl.rep3 <- apply(ctrl.rep3, 1, mean)
ctrl.rep1.meanvalue <- sweep(ctrl.rep1,1,mean.ctrl.rep1,'-')
ctrl.rep1.zt.norm <- sweep(ctrl.rep1.meanvalue,1,sd.ctrl,'/')
ctrl.rep2.meanvalue <- sweep(ctrl.rep2,1,mean.ctrl.rep2,'-')
ctrl.rep2.zt.norm <- sweep(ctrl.rep2.meanvalue,1,sd.ctrl,'/')
ctrl.rep3.meanvalue <- sweep(ctrl.rep3,1,mean.ctrl.rep3,'-')
ctrl.rep3.zt.norm <- sweep(ctrl.rep3.meanvalue,1,sd.ctrl,'/')
#calculate again the min value for each protein
min.ctrl.rep1.zt.norm <- apply(ctrl.rep1.zt.norm, 1, min)
min.ctrl.rep2.zt.norm <- apply(ctrl.rep2.zt.norm, 1, min)
min.ctrl.rep3.zt.norm <- apply(ctrl.rep3.zt.norm, 1, min)
#substract the min value from each position to discard the 0
ctrl.rep1.zt.norm.pos <- sweep(ctrl.rep1.zt.norm,1,min.ctrl.rep1.zt.norm,FUN = '-')
ctrl.rep2.zt.norm.pos <- sweep(ctrl.rep2.zt.norm,1,min.ctrl.rep2.zt.norm,FUN = '-')
ctrl.rep3.zt.norm.pos <- sweep(ctrl.rep3.zt.norm,1,min.ctrl.rep3.zt.norm,FUN = '-')
sd.rnase = apply(rnase.rep1, 1, sd)
mean.rnase.rep1 <- apply(rnase.rep1, 1, mean)
mean.rnase.rep2 <- apply(rnase.rep2, 1, mean)
mean.rnase.rep3 <- apply(rnase.rep3, 1, mean)
rnase.rep1.meanvalue <- sweep(rnase.rep1,1,mean.rnase.rep1,'-')
rnase.rep1.zt.norm <- sweep(rnase.rep1.meanvalue,1,sd.rnase,'/')
rnase.rep2.meanvalue <- sweep(rnase.rep2,1,mean.rnase.rep2,'-')
rnase.rep2.zt.norm <- sweep(rnase.rep2.meanvalue,1,sd.rnase,'/')
rnase.rep3.meanvalue <- sweep(rnase.rep3,1,mean.rnase.rep3,'-')
rnase.rep3.zt.norm <- sweep(rnase.rep3.meanvalue,1,sd.rnase,'/')
#calculate again the min value for each protein
min.rnase.rep1.zt.norm <- apply(rnase.rep1.zt.norm, 1, min)
min.rnase.rep2.zt.norm <- apply(rnase.rep2.zt.norm, 1, min)
min.rnase.rep3.zt.norm <- apply(rnase.rep3.zt.norm, 1, min)
#substract the min value from each position to discard the 0
rnase.rep1.zt.norm.pos <- sweep(rnase.rep1.zt.norm,1,min.rnase.rep1.zt.norm,FUN = '-')
rnase.rep2.zt.norm.pos <- sweep(rnase.rep2.zt.norm,1,min.rnase.rep2.zt.norm,FUN = '-')
rnase.rep3.zt.norm.pos <- sweep(rnase.rep3.zt.norm,1,min.rnase.rep3.zt.norm,FUN = '-')
r1c <- ctrl.rep1.zt.norm
r2c <- ctrl.rep2.zt.norm
r3c <- ctrl.rep3.zt.norm
r1c0 <- ctrl.rep1.zt.norm
r2c0 <- ctrl.rep2.zt.norm
r3c0 <- ctrl.rep3.zt.norm
r1c0[is.na(r1c0)] <- 0
r2c0[is.na(r2c0)] <- 0
r3c0[is.na(r3c0)] <- 0
ctrl.zt.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
#View(ctrl.zt.reduced)
#dim(ctrl.zt.reduced)
r1r <- rnase.rep1.zt.norm
r2r <- rnase.rep2.zt.norm
r3r <- rnase.rep3.zt.norm
r1r0 <- rnase.rep1.zt.norm
r2r0 <- rnase.rep2.zt.norm
r3r0 <- rnase.rep3.zt.norm
r1r0[is.na(r1r0)] <- 0
r2r0[is.na(r2r0)] <- 0
r3r0[is.na(r3r0)] <- 0
rnase.zt.reduced <- (r1r0 + r2r0 + r3r0)/(3 - (sum(as.numeric(is.na(r1r[x,])) + as.numeric(is.na(r2r[x,])) + as.numeric(is.na(r3r[x,]))/25)))
#View(rnase.zt.reduced)
#dim(rnase.zt.reduced)
ctrl.rep1.zt.scaled =
sweep(ctrl.rep1.zt.norm.pos,1,100/rowSums(ctrl.rep1.zt.norm.pos),'*')
# rowSums(ctrl.rep1.zt.scaled)
ctrl.rep2.zt.scaled =
sweep(ctrl.rep2.zt.norm.pos,1,100/rowSums(ctrl.rep2.zt.norm.pos),'*')
# rowSums(ctrl.rep2.zt.scaled)
ctrl.rep3.zt.scaled =
sweep(ctrl.rep3.zt.norm.pos,1,100/rowSums(ctrl.rep3.zt.norm.pos),'*')
# rowSums(ctrl.rep3.zt.scaled)
ctrl.zt.scaled =
sweep(ctrl.zt.reduced,1,100/rowSums(ctrl.zt.reduced),'*')
rnase.rep1.zt.scaled =
sweep(rnase.rep1.zt.norm.pos,1,100/rowSums(rnase.rep1.zt.norm.pos),'*')
# rowSums(rnase.rep1.zt.scaled)
rnase.rep2.zt.scaled =
sweep(rnase.rep2.zt.norm.pos,1,100/rowSums(rnase.rep2.zt.norm.pos),'*')
# rowSums(rnase.rep2.zt.scaled)
rnase.rep3.zt.scaled =
sweep(rnase.rep3.zt.norm.pos,1,100/rowSums(rnase.rep3.zt.norm.pos),'*')
# rowSums(rnase.rep3.zt.scaled)
rnase.zt.scaled =
sweep(rnase.zt.reduced,1,100/rowSums(rnase.zt.reduced),'*')
# rowSums(rnase.zt.scaled)
ctrl.zt <- ctrl.zt.scaled
rnase.zt <- rnase.zt.scaled
View(ctrl.zt)
View(rnase.zt)
# Control Replicate 1 MMS
ctrl.rep1.mms.norm <- t(apply(ctrl.rep1, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# Control Replicate 2 MMS
ctrl.rep2.mms.norm <- t(apply(ctrl.rep2, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# Control Replicate 3 MMS
ctrl.rep3.mms.norm <- t(apply(ctrl.rep3, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# RNase Replicate 1 MMS
rnase.rep1.mms.norm <- t(apply(rnase.rep1, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# RNase Replicate 2 MMS
rnase.rep2.mms.norm <- t(apply(rnase.rep2, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# RNase Replicate 2 MMS
rnase.rep3.mms.norm <- t(apply(rnase.rep3, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
r1c <- ctrl.rep1.mms.norm
r2c <- ctrl.rep2.mms.norm
r3c <- ctrl.rep3.mms.norm
r1c0 <- ctrl.rep1.mms.norm
r2c0 <- ctrl.rep2.mms.norm
r3c0 <- ctrl.rep3.mms.norm
r1c0[is.na(r1c0)] <- 0
r2c0[is.na(r2c0)] <- 0
r3c0[is.na(r3c0)] <- 0
ctrl.mvm.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
View(ctrl.mms.reduced)
#dim(ctrl.mms.reduced)
r1r <- rnase.rep1.mms.norm
r2r <- rnase.rep2.mms.norm
r3r <- rnase.rep3.mms.norm
r1r0 <- rnase.rep1.mms.norm
r2r0 <- rnase.rep2.mms.norm
r3r0 <- rnase.rep3.mms.norm
r1r0[is.na(r1r0)] <- 0
r2r0[is.na(r2r0)] <- 0
r3r0[is.na(r3r0)] <- 0
rnase.mms.reduced <- (r1r0 + r2r0 + r3r0)/(3 - (sum(as.numeric(is.na(r1r[x,])) + as.numeric(is.na(r2r[x,])) + as.numeric(is.na(r3r[x,]))/25)))
#View(rnase.mms.reduced)
#dim(rnase.mms.reduced)
ctrl.mms.scaled <- t(apply(ctrl.mms.reduced, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
rnase.mms.scaled <- t(apply(rnase.mms.reduced, 1, function(x){
normalized <- (x-min(x))/(max(x)-min(x))
}))
##plots of the scaled replicates
plot(rnase.rep1.mms.norm[1,], xlab="fraction", ylab="protein amount", col="green", pch=20)
plot(rnase.rep2.mms.norm[1,], xlab="fraction", ylab="protein amount", col="green", pch=20)
plot(rnase.rep3.mms.norm[1,], xlab="fraction", ylab="protein amount", col="green", pch=20) #hier kann nichts geplottet werden, da das 3. replikat nicht verwendet wird
ctrl.mms <- ctrl.mms.scaled
rnase.mms <- rnase.mms.scaled
View(ctrl.mms)
View(rnase.mms)
dim(ctrl.mms)
ctrl.mms <- ctrl.mms.scaled
rnase.mms <- rnase.mms.scaled
View(ctrl.mms)
View(rnase.mms)
dim(ctrl.mms)
dim(rnase.mms)
dim(ctrl.mms)
ctrl.rep1.reprod <- MS_Table_reordered[,1:25]
ctrl.rep2.reprod <- MS_Table_reordered[,26:50]
ctrl.rep3.reprod <- MS_Table_reordered[,51:75]
rnase.rep1.reprod <- MS_Table_reordered[,76:100]
rnase.rep2.reprod <- MS_Table_reordered[,101:125]
rnase.rep3.reprod <- MS_Table_reordered[,126:150]
ctrl.cor <-
cbind(ctrl.cor.rep1.rep2 <-
sapply(seq.int(dim(ctrl.rep1.reprod)[1]), function(x) cor(as.numeric(ctrl.rep1.reprod[x,]), as.numeric(ctrl.rep2.reprod[x,]))),
ctrl.cor.rep2.rep3 <-
sapply(seq.int(dim(ctrl.rep1.reprod)[1]), function(x) cor(as.numeric(ctrl.rep2.reprod[x,]), as.numeric(ctrl.rep3.reprod[x,]))),
ctrl.cor.rep1.rep3 <-
sapply(seq.int(dim(ctrl.rep1.reprod)[1]), function(x) cor(as.numeric(ctrl.rep1.reprod[x,]), as.numeric(ctrl.rep3.reprod[x,]))))
rnase.cor <-
cbind(rnase.cor.rep1.rep2 <-
sapply(seq.int(dim(rnase.rep1.reprod)[1]), function(x) cor(as.numeric(rnase.rep1.reprod[x,]), as.numeric(rnase.rep2.reprod[x,]))),
rnase.cor.rep2.rep3 <-
sapply(seq.int(dim(rnase.rep1.reprod)[1]), function(x) cor(as.numeric(rnase.rep2.reprod[x,]), as.numeric(rnase.rep3.reprod[x,]))),
rnase.cor.rep1.rep3 <-
sapply(seq.int(dim(rnase.rep1.reprod)[1]), function(x) cor(as.numeric(rnase.rep1.reprod[x,]), as.numeric(rnase.rep3.reprod[x,]))))
ctrl.rnase.cor <- cbind(ctrl.cor,rnase.cor)
total.na <- which(rowSums(is.na(ctrl.rnase.cor)) > 0)
length(total.na)
MS.Table.naremoved <- MS_Table_reordered[-total.na,]
ctrl.rep1.naremoved <- MS.Table.naremoved[,1:25]
ctrl.rep2.naremoved <- MS.Table.naremoved[,26:50]
ctrl.rep3.naremoved <- MS.Table.naremoved[,51:75]
rnase.rep1.naremoved <- MS.Table.naremoved[,76:100]
rnase.rep2.naremoved <- MS.Table.naremoved[,101:125]
rnase.rep3.naremoved <- MS.Table.naremoved[,126:150]
ctrl.cor.naremoved <-
cbind(ctrl.cor.rep1.rep2.naremoved <-
sapply(seq.int(dim(ctrl.rep1.naremoved)[1]), function(x) cor(as.numeric(ctrl.rep1.naremoved[x,]), as.numeric(ctrl.rep2.naremoved[x,]))),
ctrl.cor.rep2.rep3.naremoved <-
sapply(seq.int(dim(ctrl.rep1.naremoved)[1]), function(x) cor(as.numeric(ctrl.rep2.naremoved[x,]), as.numeric(ctrl.rep3.naremoved[x,]))),
ctrl.cor.rep1.rep3.naremoved <-
sapply(seq.int(dim(ctrl.rep1.naremoved)[1]), function(x) cor(as.numeric(ctrl.rep1.naremoved[x,]), as.numeric(ctrl.rep3.naremoved[x,]))))
rnase.cor.naremoved <-
cbind(rnase.cor.rep1.rep2.naremoved <-
sapply(seq.int(dim(rnase.rep1.naremoved)[1]), function(x) cor(as.numeric(rnase.rep1.naremoved[x,]), as.numeric(rnase.rep2.naremoved[x,]))),
rnase.cor.rep2.rep3.naremoved <-
sapply(seq.int(dim(rnase.rep1.naremoved)[1]), function(x) cor(as.numeric(rnase.rep2.naremoved[x,]), as.numeric(rnase.rep3.naremoved[x,]))),
rnase.cor.rep1.rep3.naremoved <-
sapply(seq.int(dim(rnase.rep1.naremoved)[1]), function(x) cor(as.numeric(rnase.rep1.naremoved[x,]), as.numeric(rnase.rep3.naremoved[x,]))))
#View(ctrl.cor.naremoved)
library(ggplot2)
ctrl.cor.data.frame.naremoved <- data.frame(c(ctrl.cor.naremoved[,1],ctrl.cor.naremoved[,2],ctrl.cor.naremoved[,3]))
colnames(ctrl.cor.data.frame.naremoved) <- "correlation"
ggplot(ctrl.cor.data.frame.naremoved, aes(x=correlation)) + geom_histogram()
non.reproducible.ctrl <- which(rowSums(ctrl.cor.naremoved<0.9)>2)
#length(non.reproducible.ctrl)
non.reproducible.rnase <- which(rowSums(rnase.cor.naremoved<0.9)>2)
#length(non.reproducible.rnase)
non.reproducible <- unique(c(which(rowSums(ctrl.cor.naremoved<0.9)>2), which(rowSums(rnase.cor.naremoved<0.9)>2)))
#length(non.reproducible)
#View(rnase.cor.naremoved)
#length(non.reproducible)
length(non.reproducible.rnase)
length(non.reproducible.ctrl)
length(non.reproducible)
#View(non.reproducible)
ctrl.rep <- MS.Table.naremoved[-non.reproducible,1:75]
rnase.rep <- MS.Table.naremoved[-non.reproducible,76:150]
ctrl.cor.removed <- ctrl.cor.naremoved [-non.reproducible,]
rnase.cor.removed <- rnase.cor.naremoved [-non.reproducible,]
#View(rnase.rep)
dim(rnase.rep)
dim(ctrl.rep)
View(ctrl.rep)
for (x in 1:dim(ctrl.rep)[1]){
if (ctrl.cor.removed[x, 1] < 0.9) {
if (ctrl.cor.removed[x, 3] < 0.9){
ctrl.rep[x, 1:25] <- NA
}
if (rnase.cor.removed[x, 2] < 0.9){
ctrl.rep[x, 26:50] <- NA
}}
if (rnase.cor.removed[x, 3] < 0.9) {
if (rnase.cor.removed[x, 2] < 0.9){
ctrl.rep[x, 51:75] <- NA
}
}
}
for (x in 1:dim(rnase.rep)[1]){
if (rnase.cor.removed[x, 1] < 0.9) {
if (rnase.cor.removed[x, 3] < 0.9){
rnase.rep[x, 1:25] <- NA
}
if (rnase.cor.removed[x, 2] < 0.9){
rnase.rep[x, 26:50] <- NA
}}
if (rnase.cor.removed[x, 3] < 0.9) {
if (rnase.cor.removed[x, 2] < 0.9){
rnase.rep[x, 51:75] <- NA
}
}
}
#Nr <- c(1:dim(rnase.rep)[1])
#rnase.with.proteinnumbers <- cbind(Nr, rnase.rep[,1:25], Nr, rnase.rep[,26:50], Nr, rnase.rep[,51:75])
#View(rnase.with.proteinnumbers)
#dim(rnase.rep)
#View(rnase.cor.removed)
ctrl.clean <- ctrl.rep
rnase.clean <- rnase.rep
dim(ctrl.clean)
ctrl.rep1 <- ctrl.clean[,1:25]
ctrl.rep2 <- ctrl.clean[,26:50]
ctrl.rep3 <- ctrl.clean[,51:75]
rnase.rep1 <- rnase.clean[,1:25]
rnase.rep2 <- rnase.clean[,26:50]
rnase.rep3 <- rnase.clean[,51:75]
dim(rnase.rep3)
dim(ctrl.rep3)
# Control Replicate 1 MMS
ctrl.rep1.mms.norm <- t(apply(ctrl.rep1, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# Control Replicate 2 MMS
ctrl.rep2.mms.norm <- t(apply(ctrl.rep2, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# Control Replicate 3 MMS
ctrl.rep3.mms.norm <- t(apply(ctrl.rep3, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# RNase Replicate 1 MMS
rnase.rep1.mms.norm <- t(apply(rnase.rep1, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# RNase Replicate 2 MMS
rnase.rep2.mms.norm <- t(apply(rnase.rep2, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
# RNase Replicate 2 MMS
rnase.rep3.mms.norm <- t(apply(rnase.rep3, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
r1c <- ctrl.rep1.mms.norm
r2c <- ctrl.rep2.mms.norm
r3c <- ctrl.rep3.mms.norm
r1c0 <- ctrl.rep1.mms.norm
r2c0 <- ctrl.rep2.mms.norm
r3c0 <- ctrl.rep3.mms.norm
r1c0[is.na(r1c0)] <- 0
r2c0[is.na(r2c0)] <- 0
r3c0[is.na(r3c0)] <- 0
ctrl.mvm.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
#View(ctrl.mms.reduced)
#dim(ctrl.mms.reduced)
r1r <- rnase.rep1.mms.norm
r2r <- rnase.rep2.mms.norm
r3r <- rnase.rep3.mms.norm
r1r0 <- rnase.rep1.mms.norm
r2r0 <- rnase.rep2.mms.norm
r3r0 <- rnase.rep3.mms.norm
r1r0[is.na(r1r0)] <- 0
r2r0[is.na(r2r0)] <- 0
r3r0[is.na(r3r0)] <- 0
rnase.mms.reduced <- (r1r0 + r2r0 + r3r0)/(3 - (sum(as.numeric(is.na(r1r[x,])) + as.numeric(is.na(r2r[x,])) + as.numeric(is.na(r3r[x,]))/25)))
#View(rnase.mms.reduced)
#dim(rnase.mms.reduced)
ctrl.mms.scaled <- t(apply(ctrl.mms.reduced, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
rnase.mms.scaled <- t(apply(rnase.mms.reduced, 1, function(x){
normalized <- (x-min(x))/(max(x)-min(x))
}))
ctrl.mms <- ctrl.mms.scaled
rnase.mms <- rnase.mms.scaled
View(ctrl.mms)
View(rnase.mms)
dim(ctrl.mms)
dim(ctrl.mms.scaled)
dim(ctrl.mms.scaled)
dim(rnase.mms.reduced)
dim(ctrl.mms.reduced)
#View(ctrl.mms.reduced)
dim(ctrl.mms.reduced)
dim(ctrl.rep1)
dim(ctrl.rep1.mms.norm)
dim(ctrl.rep2.mms.norm)
dim(ctrl.rep3.mms.norm)
sim(r1c)
dim(r1c)
r1c <- ctrl.rep1.mms.norm
r2c <- ctrl.rep2.mms.norm
r3c <- ctrl.rep3.mms.norm
r1c0 <- ctrl.rep1.mms.norm
r2c0 <- ctrl.rep2.mms.norm
r3c0 <- ctrl.rep3.mms.norm
r1c0[is.na(r1c0)] <- 0
r2c0[is.na(r2c0)] <- 0
r3c0[is.na(r3c0)] <- 0
ctrl.mvm.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
dim(r1c)
#View(ctrl.mms.reduced)
dim(ctrl.mms.reduced)
dim(r2c)
dim(r3c)
dim(r3c0)
dim(r1c0)
dim(r2c0)
ctrl.mms.reduced <- (r1c0 + r2c0 + r3c0)/(3 - (sum(as.numeric(is.na(r1c[x,])) + as.numeric(is.na(r2c[x,])) + as.numeric(is.na(r3c[x,]))/25)))
#View(ctrl.mms.reduced)
dim(ctrl.mms.reduced)
ctrl.mms.scaled <- t(apply(ctrl.mms.reduced, 1, function(x) {
normalized <- (x-min(x))/(max(x)-min(x))
}))
rnase.mms.scaled <- t(apply(rnase.mms.reduced, 1, function(x){
normalized <- (x-min(x))/(max(x)-min(x))
}))
ctrl.mms <- ctrl.mms.scaled
rnase.mms <- rnase.mms.scaled
View(ctrl.mms)
View(rnase.mms)
dim(ctrl.mms)
